<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Multi-Platform Admin - Starter</title>
  <style>
    body{font-family: Arial, sans-serif; padding:20px; max-width:900px; margin:auto;}
    input, textarea, select{width:100%; padding:8px; margin:6px 0;}
    button{padding:10px 14px;}
    .row{display:flex; gap:12px;}
    .col{flex:1;}
  </style>
</head>
<body>
  <h1>Multi-Platform Admin (Starter)</h1>
  <section>
    <h2>Connect a platform (demo)</h2>
    <div>
      <select id="platformSelect">
        <option value="instagram">Instagram</option>
        <option value="facebook">Facebook</option>
        <option value="twitter">Twitter</option>
        <option value="youtube">YouTube</option>
      </select>
      <button onclick="connect()">Connect (demo)</button>
    </div>
    <div id="connectResult"></div>
  </section>

  <section>
    <h2>Create / Schedule Post</h2>
    <textarea id="content" placeholder="Write your post..."></textarea>
    <input id="media" placeholder="Media URL (optional)" />
    <label>Platforms:</label>
    <select id="platforms" multiple size="4">
      <option value="instagram">Instagram</option>
      <option value="facebook">Facebook</option>
      <option value="twitter">Twitter</option>
      <option value="youtube">YouTube</option>
    </select>
    <label>Schedule (UTC ISO, leave empty to post now):</label>
    <input id="schedule" placeholder="e.g. 2025-09-18T12:00:00" />
    <button onclick="createPost()">Create / Schedule</button>
    <div id="postResult"></div>
  </section>

  <section>
    <h2>Scheduled / Published Posts</h2>
    <button onclick="loadPosts()">Refresh</button>
    <ul id="postsList"></ul>
  </section>

<script>
  const API = 'http://localhost:5000';
  async function connect() {
    const p = document.getElementById('platformSelect').value;
    const res = await fetch(API + '/accounts/connect/' + p, {redirect: 'follow'});
    const data = await res.json();
    document.getElementById('connectResult').innerText = JSON.stringify(data);
  }
  async function createPost() {
    const content = document.getElementById('content').value;
    const media = document.getElementById('media').value;
    const sel = document.getElementById('platforms');
    const platforms = Array.from(sel.selectedOptions).map(o => o.value);
    const schedule_at = document.getElementById('schedule').value || null;
    const res = await fetch(API + '/content/create', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({content, media_url: media, platforms, schedule_at})
    });
    const data = await res.json();
    document.getElementById('postResult').innerText = JSON.stringify(data);
    loadPosts();
  }
  async function loadPosts() {
    const res = await fetch(API + '/content/list');
    const data = await res.json();
    const ul = document.getElementById('postsList');
    ul.innerHTML = '';
    data.forEach(p => {
      const li = document.createElement('li');
      li.innerText = `[${p.status}] ${p.schedule_at} -> ${p.platforms.join(', ')} : ${p.content.substring(0,120)}`;
      ul.appendChild(li);
    });
  }
  loadPosts();
</script>
</body>
</html>
